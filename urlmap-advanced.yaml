name: urlmap-advanced
defaultService: https://www.googleapis.com/compute/v1/projects/formation-gcp-networking-2025/global/backendServices/backend-web
hostRules:
- hosts:
  - "*"
  pathMatcher: main-matcher
pathMatchers:
- name: main-matcher
  defaultService: https://www.googleapis.com/compute/v1/projects/formation-gcp-networking-2025/global/backendServices/backend-web
  routeRules:
  # Route basée sur le header
  - priority: 1
    matchRules:
    - prefixMatch: /api
      headerMatches:
      - headerName: X-API-Version
        exactMatch: "v2"
    service: https://www.googleapis.com/compute/v1/projects/formation-gcp-networking-2025/global/backendServices/backend-api
  # Route par défaut pour /api
  - priority: 2
    matchRules:
    - prefixMatch: /api
    service: https://www.googleapis.com/compute/v1/projects/formation-gcp-networking-2025/global/backendServices/backend-api
  # Contenu statique
  - priority: 3
    matchRules:
    - prefixMatch: /static
    service: https://www.googleapis.com/compute/v1/projects/formation-gcp-networking-2025/global/backendBuckets/bucket-static
